import{P as p,j as e,g as ce,C as G,r as v,B,h as J,u as ae}from"./index-f41e202c.js";import{P,T as w,I as ve}from"./PageTitle-813aa65d.js";import{M as Pe}from"./MainDisplayLayout-d09b03e3.js";import{I as Oe}from"./ItemCard-d3f21380.js";import{d as L,i as xe,j as he,T as ue,a as je,b as $,c as fe,f as ge,e as K,g as Q}from"./BorrowedItemStatusConstantHelper-8564e112.js";import{f as k}from"./BorrowPurposeConstantHelper-9c404c95.js";import{u as Y,a as D}from"./useGetSpecificResource-b6e1fc28.js";import{E as O}from"./ErrorSnackbar-5754b467.js";import{a as ee,D as F,C as Ce}from"./CustomModal-4febcc1e.js";import{f as se,B as Le}from"./BorrowedItemsTable-f1a6c4e1.js";import{u as me,C as q}from"./index.esm-8acd0e2d.js";import{u as re}from"./usePatch-3139a8d1.js";import{S as oe}from"./SuccessSnackbar-f9ca460b.js";import{M as Ae,T as te}from"./TextField-e62d7a75.js";import{M as Me}from"./MenuItem-522e4baa.js";import{M as Ne,a as ze}from"./Switch-c637d4ab.js";import{I as ie}from"./createSvgIcon-c14e487a.js";import{E as Be}from"./EndorsementItemCard-f29c22da.js";import"./Popover-d6de1df7.js";import"./Typography-4dccc67c.js";import"./extendSxProp-7d097ed5.js";import"./SidebarStore-74a9779a.js";import"./subtle-prism-5d1a98b4.js";import"./BORROW_PURPOSES-6419a447.js";import"./List-155c9747.js";import"./listItemIconClasses-557778f2.js";import"./listItemTextClasses-2b03eef6.js";import"./SwitchBase-1c6aef32.js";const Z="/office/borrow-transaction",ne=o=>`/office/borrow-transaction/${o}`,Fe=o=>`/office/borrow-transaction/${o}/borrow-approval`,Ge=o=>`/office/borrow-transaction/${o}/release-item`,qe=o=>`/office/borrow-transaction/${o}/facilitate-item-return`,V={padding:"4px 4px 4px 0",margin:0,fontWeight:"500",color:"#f3f4f6"},ye=({transacData:o,onClickCard:j})=>{const c=`${o==null?void 0:o.id.slice(0,8)}...${o==null?void 0:o.id.slice(-8)}`,u=L(o==null?void 0:o.created_at),h=k(o==null?void 0:o.purpose),l=`${(o==null?void 0:o.user_defined_purpose.length)>30?(o==null?void 0:o.user_defined_purpose.slice(0,30))+"...":o==null?void 0:o.user_defined_purpose}`;return e.jsx(Oe,{onClick:j,children:e.jsxs("div",{style:{padding:"12px"},children:[e.jsx("h4",{style:{overflow:"hidden",whiteSpace:"nowrap",margin:0,padding:"4px 4px 4px 0",color:"#f3f4f6"},children:c}),e.jsx("p",{style:V,children:o==null?void 0:o.borrower}),e.jsxs("p",{style:V,children:["For ",h.purpose,", ",l]}),e.jsxs("p",{style:V,children:["Sumitted on ",u]})]})})};ye.propTypes={transacData:p.object.isRequired,onClickCard:p.func.isRequired};const le=({sectionTitle:o,list:j,isLoading:c,fetchItemFunction:u,setIsModalOpen:h})=>e.jsxs(e.Fragment,{children:[e.jsx(P,{fontSize:"1.2rem",children:o}),e.jsx("div",{style:{display:"flex",gap:"16px",flexWrap:"wrap",width:"100%"},children:c?e.jsx(ce,{}):e.jsxs(e.Fragment,{children:[j.length>0&&j.map(l=>e.jsx(ye,{transacData:l,onClickCard:()=>{u(l==null?void 0:l.id),h(!0)}},l==null?void 0:l.id)),j.length===0&&e.jsx("p",{style:{width:"100%",textAlign:"center"},children:"No requests found."})]})})]});le.propTypes={list:p.array.isRequired,sectionTitle:p.string.isRequired,isLoading:p.bool.isRequired,fetchItemFunction:p.func.isRequired,setIsModalOpen:p.func.isRequired};const $e=["Pending Return","RETURNED","DAMAGED_BUT_REPAIRABLE","UNREPAIRABLE","UNRETURNED","LOST"],ke=xe(),Ve=he(),W="Pending Return",de=["ID","Item","Start Date","End Date","Status","Penalty","Remarks"];let U={padding:"12px 12px 12px 0",margin:0,fontSize:"0.875rem",whiteSpace:"nowrap"};const Se=({borrowedItems:o,transacId:j,setIsModalOpen:c})=>{var i;const{neutralMain:u}=G();U={...U,color:u};const h={component:"th",scope:"row",style:U},{handleSubmit:l,control:t,setValue:d,reset:s,watch:r}=me(),S=(n,y)=>d(`items[${n}].borrowed_item_id`,y,{shouldDirty:!0}),{isPatchSuccess:R,isPatchError:g,isPatchLoading:f,setIsPatchError:b,setIsPatchSuccess:E,handlePatch:A}=re(),_=n=>qe(n),m=r(),T={items:((i=m==null?void 0:m.items)==null?void 0:i.filter(n=>(n==null?void 0:n.item_status)!==W&&(n==null?void 0:n.borrowed_item_id)).map(n=>{const y={};for(const[I,x]of Object.entries(n||{}))x!=null&&x!==0&&x!==""&&(y[I]=x);return y}))||[]},M=()=>{var n;((n=T==null?void 0:T.items)==null?void 0:n.length)>0?(console.log("formatted body",T),A(_,j,T)):(c(!1),console.log(m))};return v.useEffect(()=>{if(R){const y=setTimeout(()=>{c(!1)},2e3);return()=>clearTimeout(y)}},[R]),e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:l(M),children:[e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs(ue,{sx:{minWidth:"400px"},"aria-label":"borrowed items table",children:[e.jsx(je,{children:e.jsx($,{children:de.map((n,y)=>e.jsx(w,{style:{padding:`0 ${y===de.length-1?"0":"12px"} 12px 0`,margin:0,fontSize:"0.875rem",whiteSpace:"nowrap",fontWeight:"700",color:u},children:n},n))})}),e.jsx(fe,{children:o.filter(n=>(n==null?void 0:n.status)===ke||(n==null?void 0:n.status)===Ve).map((n,y)=>e.jsxs($,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(w,{...h,children:n==null?void 0:n.apc_item_id}),e.jsx(w,{...h,children:n==null?void 0:n.model_name}),e.jsx(w,{...h,children:L(n==null?void 0:n.start_date)}),e.jsx(w,{...h,children:L(n==null?void 0:n.due_date)}),e.jsx(w,{...h,children:e.jsx(q,{name:`items[${y}].item_status`,defaultValue:W,control:t,render:({field:I})=>e.jsx(Ae,{labelId:"",id:"",value:I.value||W,onChange:x=>{I.onChange(x),S(y,n==null?void 0:n.id)},variant:"standard",fullWidth:!0,children:$e.map(x=>{var a;return e.jsx(Me,{value:x,children:((a=ge(x))==null?void 0:a.status)||x},x)})})})}),e.jsx(w,{...h,children:e.jsx(q,{name:`items[${y}].item_penalty`,defaultValue:"",control:t,rules:{min:{value:0,message:"Input positive number"}},render:({field:I,fieldState:x})=>{var a;return e.jsx(te,{...I,type:"number",variant:"standard",error:!!(x!=null&&x.error),helperText:(a=x==null?void 0:x.error)==null?void 0:a.message,InputProps:{style:{fontSize:14},startAdornment:e.jsx(Ne,{position:"start",children:"â‚±"})},sx:{width:"70px","& input":{padding:0}}})}})}),e.jsx(w,{...h,children:e.jsx(q,{name:`items[${y}].item_remarks`,defaultValue:"",control:t,rules:{minLength:{value:5,message:"Purpose should be at least 5 characters"},maxLength:{value:100,message:"Purpose should not exceed 100 characters"},pattern:{value:/^[a-zA-Z0-9\s-]+$/,message:"Only letters, numbers, and hyphens are allowed."}},render:({field:I,fieldState:x})=>{var a;return e.jsx(te,{...I,variant:"standard",type:"string",error:!!(x!=null&&x.error),helperText:(a=x==null?void 0:x.error)==null?void 0:a.message,inputProps:{style:{fontSize:14}},sx:{width:"150px","& input":{padding:0}}})}})})]},y))})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[e.jsx(B,{color:"error",onClick:()=>{c(!1),s(),console.log(m)},children:e.jsx("p",{style:{padding:0,margin:0,fontSize:"0.875rem"},children:"Cancel"})}),e.jsx(B,{disabled:f,type:"submit",color:"success",children:e.jsx("p",{style:{padding:0,margin:0,fontSize:"0.875rem"},children:f?"Loading...":"Return Items"})})]})]}),e.jsx(oe,{isSuccess:R,setIsSuccess:E}),e.jsx(O,{error:g,setError:b})]})};Se.propTypes={transacId:p.string.isRequired,borrowedItems:p.array.isRequired,setIsModalOpen:p.func.isRequired};const Re=({specificResource:o,isModalOpen:j,setIsModalOpen:c})=>{const{isSm:u}=J(),{neutralMain:h}=G(),l={display:"flex",flexDirection:"row",alignItems:"start"},t={fontWeight:"700",padding:0,margin:0,whiteSpace:"nowrap",minWidth:"110px",fontSize:"0.875rem",color:h},d={padding:0,margin:0,fontSize:"0.875rem",color:h},s=o==null?void 0:o.transac_data,r=o==null?void 0:o.items,S=s!=null&&s.id?(s==null?void 0:s.id.slice(0,20))+"...":"",R=s!=null&&s.created_at?L(s==null?void 0:s.created_at):"",g=k(s==null?void 0:s.purpose),f=se(s==null?void 0:s.status);return e.jsx(e.Fragment,{children:e.jsx(ee,{isModalOpen:j,setModalOpen:c,desktopWidth:"60%",children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%",padding:u?"20px":"18px",gap:"12px",margin:"auto"},children:[e.jsx(F,{textAlign:"left",sx:{"&:before":{width:0},"& .MuiDivider-wrapper":{padding:"0 16px 0 0"}},children:e.jsx(P,{fontSize:"1rem",children:"Borrow Request Details"})}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Request ID"}),e.jsx("p",{style:d,children:u?S:s==null?void 0:s.id}),e.jsx(ie,{onClick:()=>K(s==null?void 0:s.id),sx:{marginLeft:"auto","&:focus":{outline:"none"}},children:e.jsx(Q,{sx:{fontSize:"14px"}})})]}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Borrower"}),e.jsx("p",{style:d,children:s==null?void 0:s.borrower})]}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Office"}),e.jsx("p",{style:d,children:s==null?void 0:s.department})]}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Submitted on"}),e.jsx("p",{style:d,children:R})]}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Purpose"}),e.jsxs("p",{style:d,children:[g==null?void 0:g.purpose,", ",s==null?void 0:s.user_defined_purpose]})]}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Endorser"}),e.jsx("p",{style:d,children:s!=null&&s.endorser?s==null?void 0:s.endorser:"None"})]}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Status"}),e.jsx("p",{style:d,children:f==null?void 0:f.transac_status})]}),e.jsx(F,{textAlign:"left",sx:{"&:before":{width:0},"& .MuiDivider-wrapper":{padding:"0 16px 0 0"},marginTop:"16px"},children:e.jsx(P,{fontSize:"1rem",children:"Requested Items"})}),r&&e.jsx(Se,{borrowedItems:r,transacId:s==null?void 0:s.id,setIsModalOpen:c})]})})})};Re.propTypes={specificResource:p.object,isModalOpen:p.bool.isRequired,setIsModalOpen:p.func.isRequired};const Ie=({sectionTitle:o,apiEndpoint:j})=>{const[c,u]=v.useState(!1),{list:h,isGetListLoading:l,isGetListError:t,setIsGetListError:d,getRequestList:s}=Y();v.useEffect(()=>{s(j)},[]);const{specificResource:r,isLoadingSpecificResource:S,isErrorSpecificResource:R,setIsErrorSpecificResource:g,fetchSpecificResource:f}=D(),b=E=>{f(ne,E+"?view_individual_items=1")};return e.jsxs(e.Fragment,{children:[e.jsx(le,{sectionTitle:o,list:h,isLoading:l,fetchItemFunction:b,setIsModalOpen:u}),(r||!S)&&e.jsx(Re,{specificResource:r,isModalOpen:c,setIsModalOpen:u}),e.jsx(O,{error:t,setError:d}),e.jsx(O,{error:R,setError:g})]})};Ie.propTypes={sectionTitle:p.string.isRequired,apiEndpoint:p.string.isRequired};const We="PENDING_BORROWING_APPROVAL",we=({specificResource:o,isModalOpen:j,setIsModalOpen:c})=>{const{isSm:u}=J(),{neutralMain:h}=G(),l={display:"flex",flexDirection:"row",alignItems:"start"},t={fontWeight:"700",padding:0,margin:0,whiteSpace:"nowrap",minWidth:"110px",fontSize:"0.875rem",color:h},d={padding:0,margin:0,fontSize:"0.875rem",color:h},{userData:s}=ae(),r=o==null?void 0:o.transac_data,S=o==null?void 0:o.items,R=r!=null&&r.id?(r==null?void 0:r.id.slice(0,20))+"...":"",g=r!=null&&r.created_at?L(r==null?void 0:r.created_at):"",f=k(r==null?void 0:r.purpose),b=se(r==null?void 0:r.status),{isPatchSuccess:E,isPatchError:A,isPatchLoading:_,setIsPatchError:m,setIsPatchSuccess:C,handlePatch:T}=re(),M=a=>Fe(a),i={approve_all_items:!0},n={approve_all_items:!1},y=(r==null?void 0:r.is_required_supervisor_approval)&&((s==null?void 0:s.role)==="SUPERVISOR"||(s==null?void 0:s.role)==="CO_SUPERVISOR"),I=(s==null?void 0:s.fullName)===(r==null?void 0:r.borrower),x=r==null?void 0:r.is_approval_overdue;return e.jsxs(e.Fragment,{children:[e.jsx(ee,{isModalOpen:j,setModalOpen:c,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%",padding:u?"20px":"18px",gap:"12px",margin:"auto"},children:[e.jsx(F,{textAlign:"left",sx:{"&:before":{width:0},"& .MuiDivider-wrapper":{padding:"0 16px 0 0"}},children:e.jsx(P,{fontSize:"1rem",children:"Borrow Request Details"})}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Request ID"}),e.jsx("p",{style:d,children:u?R:r==null?void 0:r.id}),e.jsx(ie,{onClick:()=>K(r==null?void 0:r.id),sx:{marginLeft:"auto","&:focus":{outline:"none"}},children:e.jsx(Q,{sx:{fontSize:"14px"}})})]}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Borrower"}),e.jsx("p",{style:d,children:r==null?void 0:r.borrower})]}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Office"}),e.jsx("p",{style:d,children:r==null?void 0:r.department})]}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Submitted on"}),e.jsx("p",{style:d,children:g})]}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Purpose"}),e.jsxs("p",{style:d,children:[f==null?void 0:f.purpose,", ",r==null?void 0:r.user_defined_purpose]})]}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Endorser"}),e.jsx("p",{style:d,children:r!=null&&r.endorser?r==null?void 0:r.endorser:"None"})]}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Status"}),e.jsx("p",{style:d,children:b==null?void 0:b.transac_status})]}),e.jsx(F,{textAlign:"left",sx:{"&:before":{width:0},"& .MuiDivider-wrapper":{padding:"0 16px 0 0"},marginTop:"16px"},children:e.jsx(P,{fontSize:"1rem",children:"Requested Items"})}),S&&e.jsx(Le,{borrowedItems:S}),(r==null?void 0:r.status)===We&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[e.jsx(B,{onClick:async()=>{await T(M,r==null?void 0:r.id,n),_||c(!1)},disabled:_||!y||I||x,color:"error",children:e.jsx("p",{style:{padding:0,margin:0,fontSize:"0.875rem"},children:"Decline Request"})}),e.jsx(B,{onClick:async()=>{await T(M,r==null?void 0:r.id,i),_||c(!1)},disabled:_||!y||I||x,color:"success",children:e.jsx("p",{style:{padding:0,margin:0,fontSize:"0.875rem"},children:"Approve Request"})})]})]})}),e.jsx(oe,{isSuccess:E,setIsSuccess:C}),e.jsx(O,{error:A,setError:m})]})};we.propTypes={specificResource:p.object,isModalOpen:p.bool.isRequired,setIsModalOpen:p.func.isRequired};const Ue="APPROVED",z=({filter:o,sectionTitle:j})=>{const[c,u]=v.useState(!1),[h,l]=v.useState(!1),{list:t,isGetListLoading:d,isGetListError:s,setIsGetListError:r,getRequestList:S}=Y(),R=o?"?"+o:"";v.useEffect(()=>{S(Z+R)},[]);const{specificResource:g,isLoadingSpecificResource:f,isErrorSpecificResource:b,setIsErrorSpecificResource:E,fetchSpecificResource:A}=D(),_=m=>ne(m);return console.log(h),e.jsxs(e.Fragment,{children:[e.jsx(P,{fontSize:"1.2rem",children:j}),e.jsx("div",{style:{display:"flex",gap:"16px",flexWrap:"wrap",width:"100%"},children:d?e.jsx(ce,{}):e.jsxs(e.Fragment,{children:[t.length>0&&t.map(m=>e.jsx(Be,{transacData:m,onClick:()=>{A(_,m==null?void 0:m.id),(m==null?void 0:m.status)===Ue?f||l(!0):f||u(!0)}},m==null?void 0:m.id)),t.length===0&&e.jsx("p",{style:{width:"100%",textAlign:"center"},children:"No requests found."})]})}),g&&e.jsx(we,{specificResource:g,isModalOpen:c,setIsModalOpen:u}),e.jsx(O,{error:s,setError:r}),e.jsx(O,{error:b,setError:E})]})};z.propTypes={filter:p.string,sectionTitle:p.string.isRequired};const be=({isChecked:o,isDisabled:j,onChange:c})=>e.jsx(ze,{color:"success",checked:o,disabled:j,onChange:c});be.propTypes={isChecked:p.bool.isRequired,isDisabled:p.bool.isRequired,onChange:p.func.isRequired};const He=xe(),H=he(),pe=["ID","Item","Start Date","End Date","Status","Released"],N={padding:"12px 12px 12px 0",margin:0,fontSize:"0.875rem",whiteSpace:"nowrap"},_e=({borrowedItems:o,transacId:j,setIsModalOpen:c})=>{var M;const{neutralMain:u}=G(),{handleSubmit:h,control:l,setValue:t,reset:d,watch:s}=me(),r=(i,n)=>t(`items[${i}].borrowed_item_id`,n,{shouldDirty:!0}),{isPatchSuccess:S,isPatchError:R,isPatchLoading:g,setIsPatchError:f,setIsPatchSuccess:b,handlePatch:E}=re(),A=i=>Ge(i),_=s(),C={items:((M=_==null?void 0:_.items)==null?void 0:M.filter(i=>(i==null?void 0:i.is_released)&&(i==null?void 0:i.borrowed_item_id)))||[]},T=()=>{var i;((i=C==null?void 0:C.items)==null?void 0:i.length)>0?(E(A,j,C),console.log("formatted body",C),console.log("isPatchSuccess ",S)):c(!1)};return v.useEffect(()=>{if(S){const n=setTimeout(()=>{c(!1)},2e3);return()=>clearTimeout(n)}},[S]),e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:h(T),children:[e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs(ue,{sx:{minWidth:"400px"},"aria-label":"borrowed items table",children:[e.jsx(je,{children:e.jsx($,{children:pe.map((i,n)=>e.jsx(w,{style:{padding:`0 ${n===pe.length-1?"0":"12px"} 12px 0`,margin:0,fontSize:"0.875rem",whiteSpace:"nowrap",fontWeight:"700",color:u},children:i},i))})}),e.jsx(fe,{children:o.filter(i=>(i==null?void 0:i.status)===He||(i==null?void 0:i.status)===H).map((i,n)=>{var y;return e.jsxs($,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(w,{component:"th",scope:"row",style:{...N,color:u},children:i==null?void 0:i.apc_item_id}),e.jsx(w,{component:"th",scope:"row",style:N,children:i==null?void 0:i.model_name}),e.jsx(w,{component:"th",scope:"row",style:N,children:L(i==null?void 0:i.start_date)}),e.jsx(w,{component:"th",scope:"row",style:N,children:L(i==null?void 0:i.due_date)}),e.jsx(w,{component:"th",scope:"row",style:N,children:e.jsx(Ce,{label:(y=ge(i==null?void 0:i.status))==null?void 0:y.status,size:"small",variant:"outlined",color:"primary"})}),e.jsx(w,{component:"th",scope:"row",style:N,children:e.jsx(q,{name:`items[${n}].is_released`,control:l,defaultValue:(i==null?void 0:i.status)===H,render:({field:I})=>e.jsx(be,{isDisabled:(i==null?void 0:i.status)===H,isChecked:I.value,onChange:()=>{r(n,i==null?void 0:i.id),console.log("Before field.onChange:",I.value),I.onChange(!I.value),console.log("After field.onChange:",I.value)}})})})]},n)})})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[e.jsx(B,{color:"error",onClick:()=>{c(!1),d()},children:e.jsx("p",{style:{padding:0,margin:0,fontSize:"0.875rem"},children:"Cancel"})}),e.jsx(B,{disabled:g,type:"submit",color:"success",children:e.jsx("p",{style:{padding:0,margin:0,fontSize:"0.875rem"},children:g?"Loading...":"Release Items"})})]})]}),e.jsx(oe,{isSuccess:S,setIsSuccess:b}),e.jsx(O,{error:R,setError:f})]})};_e.propTypes={transacId:p.string.isRequired,borrowedItems:p.array.isRequired,setIsModalOpen:p.func.isRequired};const Ee=({specificResource:o,isModalOpen:j,setIsModalOpen:c})=>{const{isSm:u}=J(),{neutralMain:h}=G(),l={display:"flex",flexDirection:"row",alignItems:"start"},t={fontWeight:"700",padding:0,margin:0,whiteSpace:"nowrap",minWidth:"110px",fontSize:"0.875rem",color:h},d={padding:0,margin:0,fontSize:"0.875rem",color:h},s=o==null?void 0:o.transac_data,r=o==null?void 0:o.items,S=s!=null&&s.id?(s==null?void 0:s.id.slice(0,20))+"...":"",R=s!=null&&s.created_at?L(s==null?void 0:s.created_at):"",g=k(s==null?void 0:s.purpose),f=se(s==null?void 0:s.status);return e.jsx(e.Fragment,{children:e.jsx(ee,{isModalOpen:j,setModalOpen:c,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%",padding:u?"20px":"18px",gap:"12px",margin:"auto"},children:[e.jsx(F,{textAlign:"left",sx:{"&:before":{width:0},"& .MuiDivider-wrapper":{padding:"0 16px 0 0"}},children:e.jsx(P,{fontSize:"1rem",children:"Borrow Request Details"})}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Request ID"}),e.jsx("p",{style:d,children:u?S:s==null?void 0:s.id}),e.jsx(ie,{onClick:()=>K(s==null?void 0:s.id),sx:{marginLeft:"auto","&:focus":{outline:"none"}},children:e.jsx(Q,{sx:{fontSize:"14px"}})})]}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Borrower"}),e.jsx("p",{style:d,children:s==null?void 0:s.borrower})]}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Office"}),e.jsx("p",{style:d,children:s==null?void 0:s.department})]}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Submitted on"}),e.jsx("p",{style:d,children:R})]}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Purpose"}),e.jsxs("p",{style:d,children:[g==null?void 0:g.purpose,", ",s==null?void 0:s.user_defined_purpose]})]}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Endorser"}),e.jsx("p",{style:d,children:s!=null&&s.endorser?s==null?void 0:s.endorser:"None"})]}),e.jsxs("div",{style:l,children:[e.jsx("p",{style:t,children:"Status"}),e.jsx("p",{style:d,children:f==null?void 0:f.transac_status})]}),e.jsx(F,{textAlign:"left",sx:{"&:before":{width:0},"& .MuiDivider-wrapper":{padding:"0 16px 0 0"},marginTop:"16px"},children:e.jsx(P,{fontSize:"1rem",children:"Requested Items"})}),r&&e.jsx(_e,{borrowedItems:r,transacId:s==null?void 0:s.id,setIsModalOpen:c})]})})})};Ee.propTypes={specificResource:p.object,isModalOpen:p.bool.isRequired,setIsModalOpen:p.func.isRequired};const Te=({sectionTitle:o,apiEndpoint:j})=>{const[c,u]=v.useState(!1),{list:h,isGetListLoading:l,isGetListError:t,setIsGetListError:d,getRequestList:s}=Y();v.useEffect(()=>{s(j)},[]);const{specificResource:r,isLoadingSpecificResource:S,isErrorSpecificResource:R,setIsErrorSpecificResource:g,fetchSpecificResource:f}=D(),b=E=>{f(ne,E+"?view_individual_items=1")};return e.jsxs(e.Fragment,{children:[e.jsx(le,{sectionTitle:o,list:h,isLoading:l,fetchItemFunction:b,setIsModalOpen:u}),(r||!S)&&e.jsx(Ee,{specificResource:r,isModalOpen:c,setIsModalOpen:u}),e.jsx(O,{error:t,setError:d}),e.jsx(O,{error:R,setError:g})]})};Te.propTypes={sectionTitle:p.string.isRequired,apiEndpoint:p.string.isRequired};const Xe="PENDING_BORROWING_APPROVAL",Ze="APPROVED",X="ON_GOING",Je="TRANSACTION_COMPLETE",_s=()=>e.jsx(e.Fragment,{children:e.jsx(Pe,{children:e.jsxs(ve,{children:[e.jsx(P,{children:"Manage Transactions"}),e.jsx(z,{sectionTitle:"Pending Approval",filter:"status="+Xe}),e.jsx(Te,{sectionTitle:"For Release",apiEndpoint:Z+"?status="+Ze}),e.jsx(Ie,{sectionTitle:"On Going Transactions",apiEndpoint:Z+"?status="+X}),e.jsx(z,{sectionTitle:"Delayed Returns",filter:"status="+X}),e.jsx(z,{sectionTitle:"Unreturned",filter:"status="+X}),e.jsx(z,{sectionTitle:"Lapsed Approval",filter:"is_lapsed=true"}),e.jsx(z,{sectionTitle:"Complete",filter:"status="+Je})]})})});export{_s as default};
