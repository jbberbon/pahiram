import{P as m,j as e,r as j,B as V,h as M,C as ie}from"./index-f41e202c.js";import{M as oe}from"./MainDisplayLayout-d09b03e3.js";import{P as C,I as de}from"./PageTitle-813aa65d.js";import{I as le}from"./ItemCard-d3f21380.js";import{d as Q,h as ae,e as ue,g as ce}from"./BorrowedItemStatusConstantHelper-8564e112.js";import{E as S}from"./EmptyItems-9f162a83.js";import{E as q,g as pe}from"./ErrorSnackbar-5754b467.js";import{g as U,b as xe,D as N,a as H,c as me}from"./CustomModal-4febcc1e.js";import{b as ge,c as he,d as fe,e as ye}from"./borrowRequestEndpoints-e9facb43.js";import{C as v,u as je}from"./index.esm-8acd0e2d.js";import{S as Y}from"./SuccessSnackbar-f9ca460b.js";import{u as _e,S as Re,f as ve,a as Ee,b as Z,d as z,D as be,c as Ie,R as we,e as G}from"./convertDatesToApiFormat-2fea3335.js";import{B as Ce}from"./BORROW_PURPOSES-6419a447.js";import{T as I}from"./TextField-e62d7a75.js";import{M as Oe}from"./MenuItem-522e4baa.js";import{r as qe,i as Te,I as k}from"./createSvgIcon-c14e487a.js";import{M as Be}from"./Checkbox-7312141d.js";import{f as Pe,B as Ae}from"./BorrowedItemsTable-f1a6c4e1.js";import"./SidebarStore-74a9779a.js";import"./Popover-d6de1df7.js";import"./Typography-4dccc67c.js";import"./extendSxProp-7d097ed5.js";import"./subtle-prism-5d1a98b4.js";import"./Autocomplete-fb9b1e84.js";import"./List-155c9747.js";import"./listItemIconClasses-557778f2.js";import"./listItemTextClasses-2b03eef6.js";import"./SwitchBase-1c6aef32.js";function F({transacId:u,submitDate:o,department:r,endorser:c,onClick:a}){const t=Q(o),p=`${u.slice(0,8)}...${u.slice(-8)}`;return e.jsx(le,{onClick:a,children:e.jsxs("div",{style:{padding:"12px"},children:[e.jsxs("h4",{style:{overflow:"hidden",whiteSpace:"nowrap",margin:0,padding:"4px 4px 4px 0",color:"#f3f4f6"},children:["Request - ",p]}),e.jsx("p",{style:{padding:"4px 4px 4px 0",margin:0,fontWeight:"500",overflow:"hidden",color:"#f3f4f6"},children:r}),e.jsxs("p",{style:{padding:"4px 4px 4px 0",margin:0,fontWeight:"500",color:"#f3f4f6"},children:["Sumitted on ",t]}),e.jsx("p",{style:{padding:"4px 4px 4px 0",margin:0,fontWeight:"600",color:"#f3f4f6"},children:e.jsxs("em",{children:["Endorsed by"," ",c!=null&&c.full_name?`Mr/Ms ${c.full_name}`:"N/A"]})})]})})}F.propTypes={transacId:m.string.isRequired,submitDate:m.string.isRequired,department:m.string.isRequired,endorser:m.object,onClick:m.func.isRequired};const Le=()=>{const[u,o]=j.useState([]),[r,c]=j.useState(null),[a,t]=j.useState(!1),p=async()=>{try{t(!0);const s=await U(ge);(s==null?void 0:s.status)===!1&&c(s==null?void 0:s.message),o(s==null?void 0:s.data),t(!1)}catch(h){c(h),console.error("Error fetching borrow requests:",h),t(!1)}};return j.useEffect(()=>{p()},[]),{isLoadingRequestList:a,borrowRequestList:u,isErrorRequestList:r,setErrorRequestList:c,getRequestList:p}},Se=()=>{const[u,o]=j.useState({}),[r,c]=j.useState(null),[a,t]=j.useState(!1);return{specificRequest:u,isSpecificRequestLoading:a,isErrorSpecificRequest:r,fetchSpecificRequest:async h=>{try{t(!0);const s=he(h),x=await U(s);(x==null?void 0:x.status)===!1&&c(x==null?void 0:x.message),o(x.data),t(!1)}catch(s){t(!1),c(s),console.error("Error fetching details:",s)}},setErrorSpecificRequest:c}},Ve=()=>{const[u,o]=j.useState(null),[r,c]=j.useState(null),[a,t]=j.useState(!1);return{isEditSuccess:u,isEditError:r,isEditLoading:a,setEditError:c,setEditSuccess:o,handleEditRequest:async(h,s)=>{const x=fe(h);try{t(!0);const g=await xe(x,s);if((g==null?void 0:g.status)===!1){c(g.message),t(!1);return}o(g==null?void 0:g.message),t(!1)}catch(g){console.error(g),c("An error occurred while processing the request."),t(!1)}}}};function K({control:u,setValue:o,transacData:r}){var g,_;const[c,a]=j.useState(""),t=!0,{results:p,loading:h,error:s,setError:x}=_e(c,t);return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsx(N,{textAlign:"left",sx:{"&:before":{width:0},"& .MuiDivider-wrapper":{padding:"0 16px 0 0"}},children:e.jsx(C,{fontSize:"1rem",children:"Edit Borrow Request"})}),e.jsx(I,{id:"outlined-required",label:"Office",defaultValue:r==null?void 0:r.department,variant:"standard",disabled:!0}),e.jsx(v,{name:"request_data.endorsed_by",control:u,defaultValue:((g=r==null?void 0:r.endorsed_by)==null?void 0:g.apc_id)||"",rules:{maxLength:{value:30,message:"Endorser Name should not exceed 30 characters"},pattern:{value:/^[a-zA-Z0-9\s-]+$/,message:"Invalid input. Only letters, numbers, and hyphens are allowed."},required:(_=r==null?void 0:r.endorsed_by)!=null&&_.apc_id?"You cannot remove existing endorser":!1},render:({field:y,fieldState:d})=>e.jsx(Re,{field:y,fieldState:d,disabled:!0,setSearchInput:a,label:"Not allowed to change Endorser",options:p.length>0?p:[r==null?void 0:r.endorsed_by],loading:h,setValue:o,placeholder:"Enter endorser name",defaultValue:(r==null?void 0:r.endorsed_by)||""})}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"16px"},children:[e.jsx(v,{name:"request_data.purpose",control:u,defaultValue:r==null?void 0:r.purpose,rules:{required:"Purpose is required"},render:({field:y,fieldState:d})=>{var l;return e.jsx(I,{...y,required:!0,label:"Change Purpose",variant:"standard",select:!0,disabled:!t,error:!!(d!=null&&d.error),helperText:(l=d==null?void 0:d.error)==null?void 0:l.message,sx:{flex:"1 1 8rem"},children:Object.entries(Ce).map(([n,f])=>e.jsx(Oe,{value:n,children:f.purpose},n))})}}),e.jsx(v,{name:"request_data.user_defined_purpose",control:u,defaultValue:r==null?void 0:r.user_defined_purpose,rules:{required:"Purpose is required",minLength:{value:5,message:"Purpose should be at least 5 characters"},maxLength:{value:30,message:"Purpose should not exceed 30 characters"},pattern:{value:/^[a-zA-Z0-9\s-]+$/,message:"Invalid input. Only letters, numbers, and hyphens are allowed."}},render:({field:y,fieldState:d})=>{var l;return e.jsx(I,{required:!0,...y,label:"Specify Purpose",variant:"standard",type:"text",disabled:!t,error:!!(d!=null&&d.error),helperText:(l=d==null?void 0:d.error)==null?void 0:l.message,sx:{flex:"1 1 8rem"}})}})]}),e.jsx(q,{error:s,setError:x})]})}K.propTypes={control:m.object.isRequired,setValue:m.func.isRequired,transacData:m.object.isRequired};var $={},Ne=Te;Object.defineProperty($,"__esModule",{value:!0});var J=$.default=void 0,ke=Ne(qe()),Fe=e,$e=(0,ke.default)((0,Fe.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v10zM18 4h-2.5l-.71-.71c-.18-.18-.44-.29-.7-.29H9.91c-.26 0-.52.11-.7.29L8.5 4H6c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1z"}),"DeleteRounded");J=$.default=$e;const X=({checked:u,onChange:o,disabled:r})=>e.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-end",maxHeight:"45px"},children:e.jsx(Be,{disabled:r,checked:u,onChange:o,sx:{width:"20px",padding:0},icon:e.jsx(ve,{}),checkedIcon:e.jsx(J,{sx:{color:"#D54442"}})})});X.propTypes={checked:m.bool.isRequired,disabled:m.bool.isRequired,onChange:m.func.isRequired};const D=({index:u,control:o,itemModel:r,setValue:c,filteredItems:a})=>{const{bookedDates:t,isLoading:p,isError:h,setIsError:s,getRequestList:x}=Ee(),[g,_]=j.useState(!1),y=()=>{_(l=>!l)},d=r==null?void 0:r.id;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"16px",paddingBottom:"16px",width:"100%"},children:[e.jsx(v,{name:`edit_existing_items[${u}].item_group_id`,control:o,defaultValue:d,rules:{required:"Item is required",pattern:{value:/^[a-zA-Z0-9\s-]+$/,message:"Invalid input. Only letters, numbers, and hyphens are allowed."}},render:({field:l,fieldState:n})=>e.jsx("div",{style:{flex:"1 1 8rem"},children:e.jsx(Z,{disabled:!0,field:l,fieldState:n,label:"Search Item",options:[],loading:!1,setValue:c,placeholder:"Enter item name",defaultValue:r})})}),e.jsx(v,{name:`edit_existing_items[${u}].quantity`,control:o,defaultValue:r==null?void 0:r.quantity,rules:{required:"Quantity is required",min:{value:1,message:"Quantity must be at least 1"},max:{value:3,message:"Quantity cannot exceed 3"}},render:({field:l,fieldState:n})=>{var f;return e.jsx(I,{required:!0,...l,label:"Quantity",type:"number",variant:"standard",fullWidth:!0,error:!!(n!=null&&n.error),helperText:(f=n==null?void 0:n.error)==null?void 0:f.message,sx:{flex:"1 1 2rem"}})}}),e.jsx(v,{name:`edit_existing_items[${u}].start_date`,control:o,defaultValue:r==null?void 0:r.start_date,rules:{required:"Start date is required"},render:({field:l,fieldState:n})=>{var f;return e.jsx(I,{...l,required:!0,label:"Change Item Start Date",InputLabelProps:{shrink:!0},id:"change-start-date",type:"datetime-local",variant:"standard",error:!!(n!=null&&n.error),helperText:(f=n==null?void 0:n.error)==null?void 0:f.message,InputProps:{endAdornment:e.jsx(k,{disabled:!d,onClick:()=>{x(d),setTimeout(()=>{p||y()},500)},disableRipple:!0,sx:{padding:0},children:e.jsx(z,{})})},sx:{flex:"1 1 10rem",'& input[type="datetime-local"]::-webkit-calendar-picker-indicator':{display:"none"}}})}}),e.jsx(v,{name:`edit_existing_items[${u}].return_date`,control:o,defaultValue:r==null?void 0:r.due_date,rules:{required:"Return date is required"},render:({field:l,fieldState:n})=>{var f;return e.jsx(I,{...l,required:!0,label:"Change Item Return Date",InputLabelProps:{shrink:!0},id:"change-return-date",type:"datetime-local",variant:"standard",error:!!(n!=null&&n.error),helperText:(f=n==null?void 0:n.error)==null?void 0:f.message,InputProps:{endAdornment:e.jsx(k,{disabled:!d,onClick:()=>{x(d),setTimeout(()=>{p||y()},500)},disableRipple:!0,sx:{padding:0},children:e.jsx(z,{})})},sx:{flex:"1 1 10rem",'& input[type="datetime-local"]::-webkit-calendar-picker-indicator':{display:"none"}}})}}),e.jsx(v,{name:`edit_existing_items[${u}].is_cancelled`,control:o,defaultValue:!1,render:({field:l})=>e.jsx(X,{checked:l.value,onChange:l.onChange,disabled:a.length<=1})})]},u),d&&(t==null?void 0:t.dates)&&e.jsx(be,{isModalOpen:g,setModalOpen:y,setStartDate:l=>{c(`edit_existing_items[${u}].start_date`,l,{shouldDirty:!0})},setEndDate:l=>{console.log("NEW RETURN DATE",l),c(`edit_existing_items[${u}].return_date`,l,{shouldDirty:!0})},itemGroupId:d,bookedDates:t==null?void 0:t.dates,activeItemCount:t==null?void 0:t.active_items,modelName:t==null?void 0:t.item_model}),e.jsx(q,{error:h,setError:s})]})};D.propTypes={index:m.number.isRequired,control:m.object.isRequired,itemModel:m.object.isRequired,setValue:m.func.isRequired,departmentCode:m.string.isRequired,filteredItems:m.array.isRequired};const ee=({setValue:u,control:o,itemData:r,departmentCode:c})=>{const a=ae(),t=r.filter(p=>(p==null?void 0:p.borrowed_item_status)===a);return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsx(N,{textAlign:"left",sx:{"&:before":{width:0},"& .MuiDivider-wrapper":{padding:"0 16px 0 0"},marginTop:"16px"},children:e.jsx(C,{fontSize:"1rem",children:"Edit Items"})}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"18px"},children:t&&t.map((p,h)=>(p==null?void 0:p.id)&&e.jsx(D,{index:h,itemModel:p,control:o,setValue:u,departmentCode:c,filteredItems:t},h))})]})};ee.propTypes={control:m.object.isRequired,setValue:m.func.isRequired,itemData:m.array.isRequired,departmentCode:m.string.isRequired};const se=({selectedOffice:u,control:o,setValue:r,getValues:c})=>{const[a,t]=j.useState(0),p=()=>{a<10?(t(a+1),console.log(a)):console.log("Max 10 fields")},h=d=>{t(a-1),r("add_new_items",c("add_new_items").filter((l,n)=>n!==d))},s=!0,{results:x,loading:g,error:_,setError:y}=Ie(u,s);return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"16px",width:"100%"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"row",width:"100%"},children:[e.jsx("div",{style:{maxWidth:"100%",display:"flex",alignItems:"center"},children:e.jsx(C,{fontSize:"1rem",children:"Add New Items"})}),e.jsx("hr",{style:{height:"1.5px",border:0,width:"100%",background:"#2222",margin:"auto 16px auto 16px"}}),e.jsx(V,{onClick:p,variant:"text",disabled:!s,disableElevation:!0,disableRipple:!0,sx:{padding:"8px 8px",margin:0,"&:focus":{outline:"none"}},children:e.jsx("p",{style:{margin:0,fontWeight:"500",whiteSpace:"nowrap"},children:"Add fields"})})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"18px"},children:[...Array(a).keys()].map(d=>e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"16px",paddingBottom:"16px",width:"100%"},children:[e.jsx(v,{name:`add_new_items[${d}].item_group_id`,control:o,defaultValue:"",rules:{required:"Item is required",pattern:{value:/^[a-zA-Z0-9\s-]+$/,message:"Only letters, numbers, and hyphens are allowed."}},render:({field:l,fieldState:n})=>e.jsx("div",{style:{flex:"1 1 8rem"},children:e.jsx(Z,{disabled:!1,field:l,fieldState:n,label:"Search Item",options:x,loading:g,setValue:r,placeholder:"Enter item name"})})}),e.jsx(v,{name:`add_new_items[${d}].quantity`,control:o,defaultValue:"",rules:{required:"Quantity is required",min:{value:1,message:"Quantity must be at least 1"},max:{value:3,message:"Quantity cannot exceed 3"}},render:({field:l,fieldState:n})=>{var f;return e.jsx(I,{required:!0,...l,label:"Quantity",type:"number",variant:"standard",fullWidth:!0,error:!!(n!=null&&n.error),helperText:(f=n==null?void 0:n.error)==null?void 0:f.message,sx:{flex:"1 1 2rem"}})}}),e.jsx(v,{name:`add_new_items[${d}].start_date`,control:o,defaultValue:"",rules:{required:"Start date is required"},render:({field:l,fieldState:n})=>{var f;return e.jsx(I,{...l,required:!0,label:"Change Item Start Date",InputLabelProps:{shrink:!0},id:"change-start-date",type:"datetime-local",variant:"standard",error:!!(n!=null&&n.error),helperText:(f=n==null?void 0:n.error)==null?void 0:f.message,sx:{flex:"1 1 10rem"}})}}),e.jsx(v,{name:`add_new_items[${d}].return_date`,control:o,defaultValue:"",rules:{required:"Return date is required"},render:({field:l,fieldState:n})=>{var f;return e.jsx(I,{...l,required:!0,label:"Change Item Return Date",InputLabelProps:{shrink:!0},id:"change-return-date",type:"datetime-local",variant:"standard",error:!!(n!=null&&n.error),helperText:(f=n==null?void 0:n.error)==null?void 0:f.message,sx:{flex:"1 1 10rem"}})}}),e.jsx(we,{handleRemoveField:()=>h(d)})]},d))}),e.jsx(q,{error:_,setError:y})]})};se.propTypes={selectedOffice:m.string.isRequired,control:m.object.isRequired,setValue:m.func.isRequired,getValues:m.func.isRequired};const W=(u,o)=>{let r={};return o&&(r=Object.keys(o).reduce((a,t)=>(a[t]=u[t],a),{})),r},re=({isEditOpen:u,setEditOpen:o,specificRequestData:r})=>{const{isCustom420:c}=M(),a=r==null?void 0:r.transac_data,t=r==null?void 0:r.items,{isEditSuccess:p,isEditError:h,isEditLoading:s,setEditError:x,setEditSuccess:g,handleEditRequest:_}=Ve(),{handleSubmit:y,control:d,setValue:l,getValues:n,formState:f,reset:T}=je(),{dirtyFields:O}=f,A=pe(),L=()=>{const E=n();console.log("Edit Raw",E),console.log("DIRTY FIELDS",O);let R={};const b=W(E.request_data,O.request_data);Object.keys(b).length>0&&(R={...R,request_data:{...b,apcis_token:A}});const i=W(E.edit_existing_items,O.edit_existing_items);if(Object.keys(i).length>0){let B=Object.values(i).map(P=>{if(P.is_cancelled===!0)return{item_group_id:P.item_group_id,is_cancelled:!0};const{is_cancelled:Ge,...te}=P;return te});B=G(B),R={...R,edit_existing_items:{...B}}}let w=E.add_new_items;if(w&&Object.keys(w).length>0&&(w=G(w),R={...R,add_new_items:{...w}}),Object.keys(R).length===0)return o(!1);_(a.id,R),console.log("Request Body",R),!s&&h&&o(!1)};return j.useEffect(()=>{if(p){T();const E=setTimeout(()=>{o(!1)},100);return()=>clearTimeout(E)}},[T,p,o]),e.jsxs(e.Fragment,{children:[e.jsx(H,{isModalOpen:u,setModalOpen:o,children:e.jsxs("form",{onSubmit:y(L),style:{display:"flex",flexDirection:"column",gap:c?"16px":"24px",width:"100%",padding:"16px",margin:"auto"},children:[a&&e.jsx(K,{control:d,setValue:l,transacData:a}),t&&e.jsx(ee,{itemData:t,control:d,departmentCode:a==null?void 0:a.department_acronym,setValue:l}),t&&e.jsx(se,{itemData:t,selectedOffice:a==null?void 0:a.department_acronym,control:d,setValue:l,getValues:n}),e.jsx(V,{type:"submit",disabled:s,color:"secondary",variant:"contained",sx:{width:"100%",marginTop:"12px"},children:s?"Loading...":"Submit"})]})}),e.jsx(q,{error:h,setError:x}),e.jsx(Y,{isSuccess:p,setIsSuccess:g,successMessage:p})]})};re.propTypes={isEditOpen:m.bool.isRequired,setEditOpen:m.func.isRequired,specificRequestData:m.object.isRequired};function ne({isModalOpen:u,setModalOpen:o,specificRequestData:r,handleCancelRequest:c}){var w,B,P;const{neutralMain:a}=ie(),[t,p]=j.useState(!1),{isSm:h}=M(),s=r==null?void 0:r.transac_data,x=r==null?void 0:r.items,g={display:"flex",flexDirection:"row",alignItems:"center"},_={fontWeight:"700",padding:0,margin:0,whiteSpace:"nowrap",minWidth:"110px",fontSize:"0.875rem",color:a},y={padding:0,margin:0,fontSize:"0.875rem",color:a},d=s!=null&&s.id?(s==null?void 0:s.id.slice(0,20))+"...":"",l=s!=null&&s.created_at?Q(s==null?void 0:s.created_at):"",n=Pe(s==null?void 0:s.transac_status),f="PENDING_ENDORSER_APPROVAL",T="PENDING_BORROWING_APPROVAL",O="APPROVED",A="ON_GOING",L=[f,T,O,A],E=(s==null?void 0:s.transac_status)===A,R=(s==null?void 0:s.transac_status)===O,b=(s==null?void 0:s.transac_status)===T&&((w=s==null?void 0:s.endorsed_by)==null?void 0:w.full_name)!==void 0,i=E||R||b;return e.jsxs(e.Fragment,{children:[e.jsx(H,{isModalOpen:u,setModalOpen:o,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%",padding:h?"20px":"18px",gap:"12px",margin:"auto"},children:[e.jsx(N,{textAlign:"left",sx:{"&:before":{width:0},"& .MuiDivider-wrapper":{padding:"0 16px 0 0"}},children:e.jsx(C,{fontSize:"1rem",children:"Borrow Request Details"})}),e.jsxs("div",{style:g,children:[e.jsx("p",{style:_,children:"Request ID"}),e.jsx("p",{style:y,children:h?d:s==null?void 0:s.id}),e.jsx(k,{onClick:()=>ue(s==null?void 0:s.id),sx:{marginLeft:"auto","&:focus":{outline:"none"}},children:e.jsx(ce,{sx:{fontSize:"14px"}})})]}),e.jsxs("div",{style:g,children:[e.jsx("p",{style:_,children:"Office"}),e.jsx("p",{style:y,children:s==null?void 0:s.department})]}),e.jsxs("div",{style:g,children:[e.jsx("p",{style:_,children:"Submitted on"}),e.jsx("p",{style:y,children:l})]}),e.jsxs("div",{style:g,children:[e.jsx("p",{style:_,children:"Purpose"}),e.jsx("p",{style:y,children:s==null?void 0:s.user_defined_purpose})]}),e.jsxs("div",{style:g,children:[e.jsx("p",{style:_,children:"Endorser"}),e.jsx("p",{style:y,children:(B=s==null?void 0:s.endorsed_by)!=null&&B.full_name?(P=s==null?void 0:s.endorsed_by)==null?void 0:P.full_name:"None"})]}),e.jsxs("div",{style:g,children:[e.jsx("p",{style:_,children:"Status"}),e.jsx("p",{style:y,children:n==null?void 0:n.transac_status})]}),e.jsx(N,{textAlign:"left",sx:{"&:before":{width:0},"& .MuiDivider-wrapper":{padding:"0 16px 0 0"},marginTop:"16px"},children:e.jsx(C,{fontSize:"1rem",children:"Borrowed Items"})}),x&&e.jsx(Ae,{borrowedItems:x,transacStatus:s==null?void 0:s.transac_status}),L.includes(s==null?void 0:s.transac_status)&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"8px"},children:[e.jsx(V,{disabled:i,onClick:()=>{p(!0),o(!1),console.log(n.transac_status)},color:"success",children:e.jsx("p",{style:{padding:0,margin:0,fontSize:"0.875rem"},children:"Edit Request"})}),e.jsx(V,{color:"error",onClick:()=>{c(s.id),o(!1)},children:e.jsx("p",{style:{padding:0,margin:0,fontSize:"0.875rem"},children:"Cancel Request"})})]})]})}),r&&e.jsx(re,{isEditOpen:t,setEditOpen:p,specificRequestData:r})]})}ne.propTypes={isModalOpen:m.bool.isRequired,setModalOpen:m.func.isRequired,specificRequestData:m.object.isRequired,handleCancelRequest:m.func.isRequired};const ze=()=>{const[u,o]=j.useState(null),[r,c]=j.useState(null),[a,t]=j.useState(!1);return{isLoading:a,isCancelSuccess:u,isCancelError:r,setCancelSuccess:o,setCancelError:c,handleCancelRequest:async h=>{try{t(!0);const s=ye(h),x=await me(s);console.log(x),(x==null?void 0:x.status)===!1&&c(x==null?void 0:x.message),o(x==null?void 0:x.message),t(!1)}catch(s){c((s==null?void 0:s.message)||"An unexpected error occurred"),t(!1)}}}},fs=()=>{const[u,o]=j.useState(!1),{borrowRequestList:r,isErrorRequestList:c,setErrorRequestList:a,isLoadingRequestList:t}=Le(),{specificRequest:p,isErrorSpecificRequest:h,fetchSpecificRequest:s,setErrorSpecificRequest:x}=Se(),{isCancelSuccess:g,isCancelError:_,setCancelSuccess:y,setCancelError:d,handleCancelRequest:l,isLoading:n}=ze(),E=["PENDING_ENDORSER_APPROVAL","PENDING_BORROWING_APPROVAL","APPROVED","ON_GOING","OVERDUE_TRANSACTION_COMPLETION"],R=r==null?void 0:r.filter(i=>E.includes(i.transac_status)),b=r==null?void 0:r.filter(i=>!E.includes(i.transac_status));return e.jsxs(e.Fragment,{children:[e.jsx(oe,{children:e.jsxs(de,{children:[e.jsx(C,{children:"Borrow Requests"}),e.jsx(C,{fontSize:"1.2rem",children:"On-going Requests"}),e.jsx("div",{style:{display:"flex",gap:"16px",flexWrap:"wrap",width:"100%"},children:(r==null?void 0:r.length)>0&&(R==null?void 0:R.length)>0?R.map(i=>e.jsx(F,{transacId:i==null?void 0:i.id,submitDate:i==null?void 0:i.created_at,department:i==null?void 0:i.department,endorser:i==null?void 0:i.endorsed_by,onClick:()=>{s(i==null?void 0:i.id),n||o(!0)}},i==null?void 0:i.id)):t?e.jsx(S,{message:"Fetching data. Please wait"}):e.jsx(S,{message:"You have no active request"})}),e.jsx("span",{}),e.jsx(C,{fontSize:"1.2rem",children:"Previous Requests"}),e.jsx("div",{style:{display:"flex",gap:"16px",flexWrap:"wrap",width:"100%"},children:(r==null?void 0:r.length)>0&&(b==null?void 0:b.length)>0?b.map(i=>e.jsx(F,{transacId:i==null?void 0:i.id,submitDate:i==null?void 0:i.created_at,department:i==null?void 0:i.department,endorser:i==null?void 0:i.endorsed_by,onClick:()=>{s(i==null?void 0:i.id),n||o(!0)}},i==null?void 0:i.id)):t?e.jsx(S,{message:"Fetching data. Please wait"}):e.jsx(S,{message:"You have no previous request"})})]})}),e.jsx(ne,{isModalOpen:u,setModalOpen:o,specificRequestData:p,handleCancelRequest:l}),e.jsx(Y,{isSuccess:g,setIsSuccess:y,successMessage:g}),e.jsx(q,{error:c,setError:a}),e.jsx(q,{error:h,setError:x}),e.jsx(q,{error:_,setError:d})]})};export{fs as default};
